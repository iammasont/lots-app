/*! For license information please see bundle.js.LICENSE.txt */
(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}};e.d({},{XJ:()=>$,C_:()=>Q});var t={};function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t,n){return(t=c(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var t=function(e){if("object"!=n(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==n(t)?t:t+""}e.r(t),e.d(t,{K6:()=>p,Bg:()=>y,iy:()=>m});var l={rgb:[{x:0,y:0},{x:.25,y:.25},{x:.5,y:.5},{x:.75,y:.75},{x:1,y:1}],red:[{x:0,y:0},{x:.25,y:.25},{x:.5,y:.5},{x:.75,y:.75},{x:1,y:1}],green:[{x:0,y:0},{x:.25,y:.25},{x:.5,y:.5},{x:.75,y:.75},{x:1,y:1}],blue:[{x:0,y:0},{x:.25,y:.25},{x:.5,y:.5},{x:.75,y:.75},{x:1,y:1}],currentChannel:"rgb"};function u(e){for(var t=0;t<e.length;t++){var n=e[t].x;if(Math.abs(e[t].y-n)>.01)return!1}return!0}function s(e,t){if(t<=0)return e[0].y;if(t>=1)return e[e.length-1].y;for(var n=0;n<e.length-1&&e[n+1].x<t;)n++;var r=e[n],a=e[n+1],o=(t-r.x)/(a.x-r.x);return r.y+o*(a.y-r.y)}var d=function(){return e=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.params=a(a({},JSON.parse(JSON.stringify(l))),t),this.curveCanvas=null,this.curveCtx=null,this.channelButtons={},this.activePoint=null,this.init=this.init.bind(this),this.drawCurve=this.drawCurve.bind(this),this.handleMouseDown=this.handleMouseDown.bind(this),this.handleMouseMove=this.handleMouseMove.bind(this),this.handleMouseUp=this.handleMouseUp.bind(this),this.resetCurve=this.resetCurve.bind(this)},t=[{key:"init",value:function(){console.log("Initializing Curves Panel"),this.curveCanvas=document.getElementById("curve-canvas"),this.curveCanvas?(this.curveCtx=this.curveCanvas.getContext("2d"),this.channelButtons={rgb:document.getElementById("curve-rgb"),red:document.getElementById("curve-red"),green:document.getElementById("curve-green"),blue:document.getElementById("curve-blue")},this.setupEvents(),this.updateChannelButtonUI(),this.drawCurve()):console.warn("Curve canvas not found")}},{key:"setupEvents",value:function(){var e=this;if(this.curveCanvas){this.curveCanvas.addEventListener("mousedown",this.handleMouseDown),document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp);var t=function(t){var n=e.channelButtons[t];n&&n.addEventListener("click",(function(){e.params.currentChannel=t,e.updateChannelButtonUI(),e.drawCurve()}))};for(var n in this.channelButtons)t(n);var r=document.getElementById("reset-curve-btn");r&&r.addEventListener("click",this.resetCurve)}}},{key:"updateChannelButtonUI",value:function(){for(var e in this.channelButtons){var t=this.channelButtons[e];t&&(e===this.params.currentChannel?t.classList.add("active"):t.classList.remove("active"))}}},{key:"resetCurve",value:function(){console.log("Resetting curve"),this.params[this.params.currentChannel]=JSON.parse(JSON.stringify(l[this.params.currentChannel])),this.drawCurve(),Q()}},{key:"drawCurve",value:function(){var e=this;if(this.curveCanvas&&this.curveCtx){var t=this.curveCanvas.width,n=this.curveCanvas.height;this.curveCtx.clearRect(0,0,t,n);var r,a=this.params[this.params.currentChannel];switch(this.curveCtx.fillStyle="rgba(20, 20, 20, 0.3)",this.curveCtx.fillRect(0,0,t,n),this.params.currentChannel){case"red":r="rgba(255, 100, 100, 0.8)";break;case"green":r="rgba(100, 255, 100, 0.8)";break;case"blue":r="rgba(100, 100, 255, 0.8)";break;default:r="rgba(255, 255, 255, 0.8)"}this.curveCtx.beginPath(),this.curveCtx.moveTo(a[0].x*t,(1-a[0].y)*n);for(var o=1;o<a.length;o++)this.curveCtx.lineTo(a[o].x*t,(1-a[o].y)*n);this.curveCtx.strokeStyle=r,this.curveCtx.lineWidth=2,this.curveCtx.stroke(),a.forEach((function(r,o){e.curveCtx.beginPath(),e.curveCtx.arc(r.x*t,(1-r.y)*n,5,0,2*Math.PI),0===o||o===a.length-1?e.curveCtx.fillStyle="rgba(150, 150, 150, 0.8)":e.curveCtx.fillStyle="rgba(255, 255, 255, 0.8)",e.curveCtx.fill(),e.curveCtx.strokeStyle="rgba(0, 0, 0, 0.8)",e.curveCtx.lineWidth=1,e.curveCtx.stroke()}))}else console.warn("Canvas not ready for drawing")}},{key:"handleMouseDown",value:function(e){if(this.curveCanvas){var t=this.curveCanvas.getBoundingClientRect(),n=(e.clientX-t.left)/t.width,r=1-(e.clientY-t.top)/t.height,a=this.params[this.params.currentChannel],o=1/0,i=null,c=-1;a.forEach((function(e,t){var a=e.x-n,l=e.y-r,u=Math.sqrt(a*a+l*l);u<o&&(o=u,i=e,c=t)})),o<.05&&c>0&&c<a.length-1&&(this.activePoint={point:i,index:c})}}},{key:"handleMouseMove",value:function(e){if(this.activePoint&&this.curveCanvas){var t=this.curveCanvas.getBoundingClientRect(),n=(e.clientX-t.left)/t.width,r=1-(e.clientY-t.top)/t.height;n=Math.max(0,Math.min(1,n)),r=Math.max(0,Math.min(1,r));var a=this.params[this.params.currentChannel],o=this.activePoint.index,i=a[o-1].x,c=a[o+1].x;n=Math.max(i+.01,Math.min(c-.01,n)),a[o].x=n,a[o].y=r,this.drawCurve(),Q()}}},{key:"handleMouseUp",value:function(){this.activePoint=null}},{key:"applyCurves",value:function(e,t,n){var r=this.params.rgb;return e=s(r,e),t=s(r,t),n=s(r,n),u(this.params.red)||(e=s(this.params.red,e)),u(this.params.green)||(t=s(this.params.green,t)),u(this.params.blue)||(n=s(this.params.blue,n)),{r:e,g:t,b:n}}},{key:"applyCurvesToImage",value:function(e){for(var t=e.data,n=0;n<t.length;n+=4){var r=t[n]/255,a=t[n+1]/255,o=t[n+2]/255,i=this.applyCurves(r,a,o);t[n]=Math.round(255*i.r),t[n+1]=Math.round(255*i.g),t[n+2]=Math.round(255*i.b)}return e}}],t&&i(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}(),h=null;function m(){var e,t,n,r,a,o,i,c,l,u,s,d;console.log("Initializing Basic Corrections"),$.currentLutParams.basic||($.currentLutParams.basic={contrast:1.2,saturation:1.15,redBalance:1.05,greenBalance:.95,blueBalance:1.1}),$.currentLutParams.lumetri||($.currentLutParams.lumetri={exposure:0,contrast:0,highlights:0,shadows:0,whites:0,blacks:0,temperature:0,tint:0}),e=document.getElementById("contrast"),t=document.getElementById("saturation"),n=document.getElementById("red-balance"),r=document.getElementById("green-balance"),a=document.getElementById("blue-balance"),o=document.getElementById("contrast-value"),i=document.getElementById("saturation-value"),c=document.getElementById("red-balance-value"),l=document.getElementById("green-balance-value"),u=document.getElementById("blue-balance-value"),g(e,o,"contrast"),g(t,i,"saturation"),g(n,c,"redBalance"),g(r,l,"greenBalance"),g(a,u,"blueBalance"),function(){var e=document.getElementById("basic-correction-section");if(e){e.innerHTML="",f(e,{id:"exposure-advanced",label:"Exposure",min:-5,max:5,step:.1,initialValue:$.currentLutParams.lumetri.exposure||0,paramName:"exposure"}),f(e,{id:"contrast-advanced",label:"Contrast",min:-100,max:100,step:1,initialValue:$.currentLutParams.lumetri.contrast||0,paramName:"contrast"}),f(e,{id:"highlights-advanced",label:"Highlights",min:-100,max:100,step:1,initialValue:$.currentLutParams.lumetri.highlights||0,paramName:"highlights"}),f(e,{id:"shadows-advanced",label:"Shadows",min:-100,max:100,step:1,initialValue:$.currentLutParams.lumetri.shadows||0,paramName:"shadows"}),f(e,{id:"whites-advanced",label:"Whites",min:-100,max:100,step:1,initialValue:$.currentLutParams.lumetri.whites||0,paramName:"whites"}),f(e,{id:"blacks-advanced",label:"Blacks",min:-100,max:100,step:1,initialValue:$.currentLutParams.lumetri.blacks||0,paramName:"blacks"}),f(e,{id:"temperature-advanced",label:"Temperature",min:-100,max:100,step:1,initialValue:$.currentLutParams.lumetri.temperature||0,paramName:"temperature"}),f(e,{id:"tint-advanced",label:"Tint",min:-100,max:100,step:1,initialValue:$.currentLutParams.lumetri.tint||0,paramName:"tint"});var t=document.createElement("button");t.textContent="Reset",t.className="reset-btn",t.addEventListener("click",v),e.appendChild(t)}}(),s=document.getElementById("title"),d=document.getElementById("lut-size"),s&&(s.value=$.currentLutParams.title||"Signature Look",s.addEventListener("input",(function(){$.currentLutParams.title=s.value}))),d&&(d.value=$.currentLutParams.size||"32",d.addEventListener("change",(function(){$.currentLutParams.size=parseInt(d.value)})))}function f(e,t){if(e){var n=t.id,r=t.label,a=t.min,o=t.max,i=t.step,c=t.initialValue,l=t.paramName,u=document.createElement("div");u.className="control-group";var s=document.createElement("label");s.setAttribute("for",n),s.textContent=r+" ";var d=document.createElement("span");d.id="".concat(n,"-value"),d.className="parameter-value",d.textContent=c.toFixed(1),s.appendChild(d);var h=document.createElement("input");return h.type="range",h.id=n,h.min=a,h.max=o,h.step=i,h.value=c,u.appendChild(s),u.appendChild(h),e.appendChild(u),h.addEventListener("input",(function(){$.currentLutParams.lumetri||($.currentLutParams.lumetri={}),$.currentLutParams.lumetri[l]=parseFloat(h.value),d.textContent=parseFloat(h.value).toFixed(1),Q()})),{slider:h,valueDisplay:d}}}function v(){$.currentLutParams.lumetri={exposure:0,contrast:0,highlights:0,shadows:0,whites:0,blacks:0,temperature:0,tint:0},document.querySelectorAll('#basic-correction-section input[type="range"]').forEach((function(e){var t=e.id.split("-")[0];e.value=$.currentLutParams.lumetri[t]||0;var n=document.getElementById("".concat(e.id,"-value"));n&&(n.textContent="0.0")})),Q()}function g(e,t,n){e&&t&&(e.value=$.currentLutParams.basic[n],t.textContent=$.currentLutParams.basic[n].toFixed(2),e.addEventListener("input",(function(){$.currentLutParams.basic[n]=parseFloat(e.value),t.textContent=$.currentLutParams.basic[n].toFixed(2),Q()})))}function p(e){for(var t=$.currentLutParams.basic,n=e.data,r=0;r<n.length;r+=4){var a=n[r]/255,o=n[r+1]/255,i=n[r+2]/255;if(a=y(a,t.contrast),o=y(o,t.contrast),i=y(i,t.contrast),a*=t.redBalance,o*=t.greenBalance,i*=t.blueBalance,1!==t.saturation){var c=.2126*a+.7152*o+.0722*i;a=c+t.saturation*(a-c),o=c+t.saturation*(o-c),i=c+t.saturation*(i-c)}if(t.shadowsShift&&t.highlightsShift){var l=Math.pow(1-Math.max(a,Math.max(o,i)),2),u=Math.pow(Math.max(a,Math.max(o,i)),2);a+=t.shadowsShift[0]*l+t.highlightsShift[0]*u,o+=t.shadowsShift[1]*l+t.highlightsShift[1]*u,i+=t.shadowsShift[2]*l+t.highlightsShift[2]*u}a=Math.min(1,Math.max(0,a)),o=Math.min(1,Math.max(0,o)),i=Math.min(1,Math.max(0,i)),n[r]=Math.round(255*a),n[r+1]=Math.round(255*o),n[r+2]=Math.round(255*i)}return e}function y(e,t){return.5+(e-.5)*t}function b(e,t,n){e&&t&&(e.value=$.currentLutParams.creative[n],t.textContent=$.currentLutParams.creative[n].toFixed(1),e.addEventListener("input",(function(){$.currentLutParams.creative[n]=parseFloat(e.value),t.textContent=$.currentLutParams.creative[n].toFixed(1),Q()})))}function w(e,t,n,r){var a=.2126*e+.7152*t+.0722*n,o=Math.max(e,t,n),i=Math.min(e,t,n),c=r*(1-(0===o?0:(o-i)/o));return{r:e=a+(e-a)*(1+c),g:t=a+(t-a)*(1+c),b:n=a+(n-a)*(1+c)}}function L(e,t,n,r){var a=.5*r;e=e*(1-a)+.5*a,t=t*(1-a)+.5*a,n=n*(1-a)+.5*a;var o=.1*r;return{r:e+=o,g:t+=o,b:n+=o}}function E(e,t){if(e){e.innerHTML="";var n=document.createElement("canvas");n.width=e.clientWidth||80,n.height=e.clientHeight||80,e.appendChild(n),e.style.background="conic-gradient(red, yellow, lime, cyan, blue, magenta, red)",e.style.backgroundImage="radial-gradient(circle at center, white 0%, rgba(255, 255, 255, 0) 70%), conic-gradient(red, yellow, lime, cyan, blue, magenta, red)";var r=document.createElement("div");r.className="wheel-indicator",e.appendChild(r);var a=$.currentLutParams.colorWheels[t],o=e.clientWidth/2,i=e.clientHeight/2,c=Math.min(o,i)-2,l=(a.r-128)/128,u=(a.g-128)/128,s=(a.b-128)/128,d=Math.sqrt(l*l+u*u+s*s),h=0;(d=Math.min(1,d))>0&&(h=Math.atan2(u,l),s>Math.max(l,u)&&(h=Math.PI+Math.atan2(s,-l)),h<0&&(h+=2*Math.PI));var m=Math.cos(h)*d*c,f=Math.sin(h)*d*c;I(e,r,m,f);var v=!1;e.addEventListener("mousedown",(function(e){v=!0,g(e)})),document.addEventListener("mousemove",(function(e){v&&g(e)})),document.addEventListener("mouseup",(function(){v=!1})),e.addEventListener("click",g)}function g(n){var a=e.getBoundingClientRect(),o=a.width/2,i=a.height/2,c=n.clientX-a.left-o,l=n.clientY-a.top-i,u=Math.sqrt(c*c+l*l),s=Math.min(o,i)-2;if(u<=s){I(e,r,c,l);var d=Math.atan2(l,c);d<0&&(d+=2*Math.PI);var h=u/s,m=function(e,t){var n,r,a,o=Math.floor(6*e),i=6*e-o,c=1*(1-t),l=1*(1-i*t),u=1*(1-(1-i)*t);switch(o%6){case 0:n=1,r=u,a=c;break;case 1:n=l,r=1,a=c;break;case 2:n=c,r=1,a=u;break;case 3:n=c,r=l,a=1;break;case 4:n=u,r=c,a=1;break;case 5:n=1,r=c,a=l}return{r:Math.round(255*n),g:Math.round(255*r),b:Math.round(255*a)}}(d/(2*Math.PI),h),f=Math.round(128+(m.r-128)*h),v=Math.round(128+(m.g-128)*h),g=Math.round(128+(m.b-128)*h);$.currentLutParams.colorWheels[t]={r:f,g:v,b:g},Q()}}}function x(){$.currentLutParams.colorWheels.shadowTint={r:128,g:128,b:128},$.currentLutParams.colorWheels.highlightTint={r:128,g:128,b:128},$.currentLutParams.colorWheels.tintBalance=0;var e=document.getElementById("tint-balance"),t=document.getElementById("tint-balance-value");e&&(e.value=0),t&&(t.textContent="0.0");var n=document.getElementById("shadow-color-wheel"),r=document.getElementById("highlight-color-wheel");if(n){var a=n.querySelector(".wheel-indicator");a&&I(n,a,0,0)}if(r){var o=r.querySelector(".wheel-indicator");o&&I(r,o,0,0)}Q()}function I(e,t,n,r){var a=e.clientWidth/2,o=e.clientHeight/2;t.style.left="".concat(a+n,"px"),t.style.top="".concat(o+r,"px")}function P(e,t,n,r,a,o){var i=.2126*e+.7152*t+.0722*n,c=Math.pow(1-i,2),l=Math.pow(i,2);return o>0?(c*=1-o,l=l*(1-o)+o):o<0&&(l*=1+o,c=c*(1+o)-o),e+=(r.r-128)/128*c*.5,t+=(r.g-128)/128*c*.5,n+=(r.b-128)/128*c*.5,{r:e+=(a.r-128)/128*l*.5,g:t+=(a.g-128)/128*l*.5,b:n+=(a.b-128)/128*l*.5}}var B=50;function M(){console.log("Image upload button clicked"),window.electronAPI&&"function"==typeof window.electronAPI.openFileDialog?window.electronAPI.openFileDialog({properties:["openFile"],filters:[{name:"Images",extensions:["jpg","jpeg","png","bmp"]}]}).then((function(e){e&&(console.log("Selected image:",e),$.originalImageElement.src="file://".concat(e))})).catch((function(e){console.error("Error in Electron file dialog:",e),C()})):(console.log("Using browser file input"),C())}function C(){var e=document.createElement("input");e.type="file",e.accept="image/*",e.addEventListener("change",(function(e){if(this.files&&this.files[0]){var t=this.files[0];console.log("Selected file:",t.name);var n=new FileReader;n.onload=function(e){$.originalImageElement.src=e.target.result},n.readAsDataURL(t)}})),e.click()}function S(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=document.getElementById("view-split"),r=document.getElementById("view-before"),a=document.getElementById("view-after"),o=document.getElementById("original-image-container"),i=document.getElementById("comparison-slider"),c=document.getElementById("vertical-divider");switch(n.classList.remove("active"),r.classList.remove("active"),a.classList.remove("active"),e){case"split":n.classList.add("active"),t&&(B=50),o.style.clipPath="inset(0 ".concat(100-B,"% 0 0)"),c.style.left="".concat(B,"%"),i.style.left="".concat(B,"%"),i.style.display="block",o.style.display="block",c.style.display="block";break;case"before":r.classList.add("active"),o.style.clipPath="inset(0 0 0 0)",i.style.display="none",c.style.display="none",o.style.display="block";break;case"after":a.classList.add("active"),o.style.display="none",i.style.display="none",c.style.display="none"}}function k(e){return function(e){if(Array.isArray(e))return O(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return O(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?O(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var j={custom:{contrast:1.2,saturation:1.15,redBalance:1.05,greenBalance:.95,blueBalance:1.1,shadowsShift:[.05,0,-.05],highlightsShift:[.03,.03,0]},warm:{contrast:1.1,saturation:.9,redBalance:1.15,greenBalance:.95,blueBalance:.85,shadowsShift:[.08,.02,-.05],highlightsShift:[.05,0,-.05]},cool:{contrast:1.3,saturation:.85,redBalance:.9,greenBalance:1,blueBalance:1.2,shadowsShift:[-.03,0,.08],highlightsShift:[0,0,.03]},bw:{contrast:1.5,saturation:0,redBalance:.33,greenBalance:.33,blueBalance:.33,shadowsShift:[-.05,-.05,-.05],highlightsShift:[.05,.05,.05]},film:{contrast:.9,saturation:.8,redBalance:1.1,greenBalance:1.05,blueBalance:.9,shadowsShift:[.1,.05,0],highlightsShift:[-.02,-.02,.05]}},T={};function A(e,t){var n=document.getElementById(e),r=document.getElementById("".concat(e,"-value"));n&&(n.value=t),r&&(r.textContent=t.toFixed(2))}function F(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=document.getElementById("lut-preview");if(t){var n="# LUT Preview will be generated here";window.generateCubeLUT&&(n=window.generateCubeLUT()),t.textContent=e?n:n.slice(0,500)+"..."}}function N(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e3,r=document.querySelector(".toast-container");r||((r=document.createElement("div")).className="toast-container",document.body.appendChild(r));var a=document.createElement("div");return a.className="toast toast-".concat(t),a.textContent=e,r.appendChild(a),setTimeout((function(){a.classList.add("show")}),10),setTimeout((function(){a.classList.remove("show"),setTimeout((function(){r.removeChild(a)}),300)}),n),a}function _(e){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_(e)}function U(){U=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function s(e,t,n,r){var o=t&&t.prototype instanceof p?t:p,i=Object.create(o.prototype),c=new k(r||[]);return a(i,"_invoke",{value:B(e,n,c)}),i}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=s;var h="suspendedStart",m="suspendedYield",f="executing",v="completed",g={};function p(){}function y(){}function b(){}var w={};u(w,i,(function(){return this}));var L=Object.getPrototypeOf,E=L&&L(L(O([])));E&&E!==n&&r.call(E,i)&&(w=E);var x=b.prototype=p.prototype=Object.create(w);function I(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function P(e,t){function n(a,o,i,c){var l=d(e[a],e,o);if("throw"!==l.type){var u=l.arg,s=u.value;return s&&"object"==_(s)&&r.call(s,"__await")?t.resolve(s.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):t.resolve(s).then((function(e){u.value=e,i(u)}),(function(e){return n("throw",e,i,c)}))}c(l.arg)}var o;a(this,"_invoke",{value:function(e,r){function a(){return new t((function(t,a){n(e,r,t,a)}))}return o=o?o.then(a,a):a()}})}function B(t,n,r){var a=h;return function(o,i){if(a===f)throw Error("Generator is already running");if(a===v){if("throw"===o)throw i;return{value:e,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var l=M(c,r);if(l){if(l===g)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===h)throw a=v,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=f;var u=d(t,n,r);if("normal"===u.type){if(a=r.done?v:m,u.arg===g)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(a=v,r.method="throw",r.arg=u.arg)}}}function M(t,n){var r=n.method,a=t.iterator[r];if(a===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,M(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=d(a,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function O(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function n(){for(;++a<t.length;)if(r.call(t,a))return n.value=t[a],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(_(t)+" is not iterable")}return y.prototype=b,a(x,"constructor",{value:b,configurable:!0}),a(b,"constructor",{value:y,configurable:!0}),y.displayName=u(b,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,l,"GeneratorFunction")),e.prototype=Object.create(x),e},t.awrap=function(e){return{__await:e}},I(P.prototype),u(P.prototype,c,(function(){return this})),t.AsyncIterator=P,t.async=function(e,n,r,a,o){void 0===o&&(o=Promise);var i=new P(s(e,n,r,a),o);return t.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},I(x),u(x,l,"Generator"),u(x,i,(function(){return this})),u(x,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=O,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(S),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function a(r,a){return c.type="throw",c.arg=t,n.next=r,a&&(n.method="next",n.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var l=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(l&&u){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),S(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;S(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:O(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function W(e,t,n,r,a,o,i){try{var c=e[o](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,a)}function z(e){return D.apply(this,arguments)}function D(){return e=U().mark((function e(t){var n,r,a,o,i,c,l=arguments;return U().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=l.length>1&&void 0!==l[1]?l[1]:"lut.cube",console.log("Saving LUT file"),e.prev=2,r=n.endsWith(".cube")?n:"".concat(n,".cube"),!window.electronAPI||"function"!=typeof window.electronAPI.saveLut){e.next=13;break}return e.next=7,window.electronAPI.saveLut({content:t,defaultPath:r});case 7:if(!(a=e.sent)){e.next=11;break}return N("LUT saved to: ".concat(a),"success"),e.abrupt("return",a);case 11:e.next=24;break;case 13:return o=new Blob([t],{type:"text/plain"}),i=URL.createObjectURL(o),(c=document.createElement("a")).href=i,c.download=r,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(i),N("LUT downloaded as ".concat(r),"success"),e.abrupt("return",r);case 24:e.next=31;break;case 26:return e.prev=26,e.t0=e.catch(2),console.error("Error saving LUT:",e.t0),N("Failed to save LUT file","error"),e.abrupt("return",null);case 31:case"end":return e.stop()}}),e,null,[[2,26]])})),D=function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){W(o,r,a,i,c,"next",e)}function c(e){W(o,r,a,i,c,"throw",e)}i(void 0)}))},D.apply(this,arguments);var e}function G(){var e=$.currentLutParams,t=e.size||32,n="";n+="# ".concat(e.title,"\n"),n+="# Generated by LOTS App\n\n",n+="LUT_3D_SIZE ".concat(t,"\n"),n+="DOMAIN_MIN 0.0 0.0 0.0\n",n+="DOMAIN_MAX 1.0 1.0 1.0\n\n";for(var r=1/(t-1),a=0;a<t;a++)for(var o=0;o<t;o++)for(var i=0;i<t;i++){var c=i*r,l=o*r,u=a*r;if("basic"===$.activeMode){var s=R(c,l,u);c=s.r,l=s.g,u=s.b}else{var d=q(c,l,u);c=d.r,l=d.g,u=d.b}c=Math.min(1,Math.max(0,c)),l=Math.min(1,Math.max(0,l)),u=Math.min(1,Math.max(0,u)),n+="".concat(c.toFixed(6)," ").concat(l.toFixed(6)," ").concat(u.toFixed(6),"\n")}return n}function R(e,t,n){var r=$.currentLutParams.basic||{};if(e=y(e,r.contrast||1),t=y(t,r.contrast||1),n=y(n,r.contrast||1),e*=r.redBalance||1,t*=r.greenBalance||1,n*=r.blueBalance||1,r.shadowsShift&&r.highlightsShift){var a=Math.pow(1-Math.max(e,Math.max(t,n)),2),o=Math.pow(Math.max(e,Math.max(t,n)),2);e+=r.shadowsShift[0]*a+r.highlightsShift[0]*o,t+=r.shadowsShift[1]*a+r.highlightsShift[1]*o,n+=r.shadowsShift[2]*a+r.highlightsShift[2]*o}if(void 0!==r.saturation&&1!==r.saturation){var i=.2126*e+.7152*t+.0722*n;e=i+r.saturation*(e-i),t=i+r.saturation*(t-i),n=i+r.saturation*(n-i)}return{r:e,g:t,b:n}}function q(e,t,n){var r=$.currentLutParams;if(r.lumetri&&(0!==r.lumetri.temperature||0!==r.lumetri.tint)){var a=function(e,t,n,r,a){return(r<0||r>0)&&(e*=1-.4*r,t*=1-.2*r,n*=1+.6*r),(a>0||a<0)&&(e*=1+.3*a,t*=1-.3*a,n*=1+.3*a),{r:e,g:t,b:n}}(e,t,n,r.lumetri.temperature/150,r.lumetri.tint/150);e=a.r,t=a.g,n=a.b}if(r.lumetri){if(0!==r.lumetri.exposure){var o=Math.pow(2,r.lumetri.exposure);e*=o,t*=o,n*=o}if(0!==r.lumetri.contrast){var i=1+r.lumetri.contrast/150*1.5;e=y(e,i),t=y(t,i),n=y(n,i)}}if(r.lumetri){var c=function(e,t,n,r,a,o,i){var c=.2126*e+.7152*t+.0722*n,l=Math.pow(c,2)*r+Math.pow(1-c,2)*a+Math.pow(c,4)*o+Math.pow(1-c,4)*i;return{r:e+=l,g:t+=l,b:n+=l}}(e,t,n,r.lumetri.highlights/150*1.5,r.lumetri.shadows/150*1.5,r.lumetri.whites/150*1.5,r.lumetri.blacks/150*1.5);e=c.r,t=c.g,n=c.b}if(r.colorWheels){var l=r.colorWheels.shadowTint,d=r.colorWheels.highlightTint,h=r.colorWheels.tintBalance/150;if(128!==l.r||128!==l.g||128!==l.b||128!==d.r||128!==d.g||128!==d.b||0!==h){var m=P(e,t,n,l,d,h);e=m.r,t=m.g,n=m.b}}if(r.curves){var f=r.curves.rgb;f&&(e=s(f,e),t=s(f,t),n=s(f,n)),r.curves.red&&!u(r.curves.red)&&(e=s(r.curves.red,e)),r.curves.green&&!u(r.curves.green)&&(t=s(r.curves.green,t)),r.curves.blue&&!u(r.curves.blue)&&(n=s(r.curves.blue,n))}if(r.creative){if(0!==r.creative.vibrance){var v=r.creative.vibrance/150,g=.2126*e+.7152*t+.0722*n,p=Math.max(e,t,n),b=Math.min(e,t,n),w=v*(1-(0===p?0:(p-b)/p));e=g+(e-g)*(1+w),t=g+(t-g)*(1+w),n=g+(n-g)*(1+w)}if(r.creative.fadedFilm>0){var E=L(e,t,n,r.creative.fadedFilm/100);e=E.r,t=E.g,n=E.b}}return{r:e,g:t,b:n}}function X(e){return X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},X(e)}function V(){V=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function s(e,t,n,r){var o=t&&t.prototype instanceof p?t:p,i=Object.create(o.prototype),c=new k(r||[]);return a(i,"_invoke",{value:B(e,n,c)}),i}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=s;var h="suspendedStart",m="suspendedYield",f="executing",v="completed",g={};function p(){}function y(){}function b(){}var w={};u(w,i,(function(){return this}));var L=Object.getPrototypeOf,E=L&&L(L(O([])));E&&E!==n&&r.call(E,i)&&(w=E);var x=b.prototype=p.prototype=Object.create(w);function I(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function P(e,t){function n(a,o,i,c){var l=d(e[a],e,o);if("throw"!==l.type){var u=l.arg,s=u.value;return s&&"object"==X(s)&&r.call(s,"__await")?t.resolve(s.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):t.resolve(s).then((function(e){u.value=e,i(u)}),(function(e){return n("throw",e,i,c)}))}c(l.arg)}var o;a(this,"_invoke",{value:function(e,r){function a(){return new t((function(t,a){n(e,r,t,a)}))}return o=o?o.then(a,a):a()}})}function B(t,n,r){var a=h;return function(o,i){if(a===f)throw Error("Generator is already running");if(a===v){if("throw"===o)throw i;return{value:e,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var l=M(c,r);if(l){if(l===g)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===h)throw a=v,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=f;var u=d(t,n,r);if("normal"===u.type){if(a=r.done?v:m,u.arg===g)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(a=v,r.method="throw",r.arg=u.arg)}}}function M(t,n){var r=n.method,a=t.iterator[r];if(a===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,M(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=d(a,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function O(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function n(){for(;++a<t.length;)if(r.call(t,a))return n.value=t[a],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(X(t)+" is not iterable")}return y.prototype=b,a(x,"constructor",{value:b,configurable:!0}),a(b,"constructor",{value:y,configurable:!0}),y.displayName=u(b,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,l,"GeneratorFunction")),e.prototype=Object.create(x),e},t.awrap=function(e){return{__await:e}},I(P.prototype),u(P.prototype,c,(function(){return this})),t.AsyncIterator=P,t.async=function(e,n,r,a,o){void 0===o&&(o=Promise);var i=new P(s(e,n,r,a),o);return t.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},I(x),u(x,l,"Generator"),u(x,i,(function(){return this})),u(x,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=O,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(S),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function a(r,a){return c.type="throw",c.arg=t,n.next=r,a&&(n.method="next",n.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var l=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(l&&u){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),S(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;S(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:O(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function H(e,t,n,r,a,o,i){try{var c=e[o](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,a)}function J(){return Y.apply(this,arguments)}function Y(){return(e=V().mark((function e(){var t,n;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Exporting LUT"),e.prev=1,t=G(),n=Z($.currentLutParams.title),e.next=6,z(t,n);case 6:e.sent?console.log("LUT exported successfully"):console.warn("LUT export was cancelled or failed"),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),console.error("Error exporting LUT:",e.t0),N("Failed to export LUT: "+e.t0.message,"error");case 14:case"end":return e.stop()}}),e,null,[[1,10]])})),Y=function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){H(o,r,a,i,c,"next",e)}function c(e){H(o,r,a,i,c,"throw",e)}i(void 0)}))}).apply(this,arguments);var e}function Z(e){if(!e)return"lut.cube";var t=e.replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_-]/g,"").toLowerCase();return t.endsWith(".cube")||(t+=".cube"),t}function K(e){return"basic"===$.activeMode?function(e){if(console.log("Processing image with basic adjustments"),!e)return console.error("No image to process"),null;try{var t=document.createElement("canvas"),n=t.getContext("2d");t.width=e.naturalWidth,t.height=e.naturalHeight,n.drawImage(e,0,0);var r=n.getImageData(0,0,t.width,t.height);return p(r),n.putImageData(r,0,0),t.toDataURL("image/jpeg",1)}catch(e){return console.error("Error processing image:",e),null}}(e):function(e){if(console.log("Processing image with advanced adjustments"),!e)return console.error("No image to process"),null;try{var t=document.createElement("canvas"),n=t.getContext("2d");t.width=e.naturalWidth,t.height=e.naturalHeight,n.drawImage(e,0,0);var r=n.getImageData(0,0,t.width,t.height);return function(e){for(var t=$.currentLutParams.colorWheels,n=e.data,r=0;r<n.length;r+=4){var a=P(n[r]/255,n[r+1]/255,n[r+2]/255,t.shadowTint,t.highlightTint,t.tintBalance/150);n[r]=Math.round(255*Math.min(1,Math.max(0,a.r))),n[r+1]=Math.round(255*Math.min(1,Math.max(0,a.g))),n[r+2]=Math.round(255*Math.min(1,Math.max(0,a.b)))}}(r),function(e){for(var t=$.currentLutParams.creative,n=e.data,r=0;r<n.length;r+=4){var a=n[r]/255,o=n[r+1]/255,i=n[r+2]/255;if(0!==t.vibrance){var c=w(a,o,i,t.vibrance/150);a=c.r,o=c.g,i=c.b}if(t.fadedFilm>0){var l=L(a,o,i,t.fadedFilm/100);a=l.r,o=l.g,i=l.b}a=Math.min(1,Math.max(0,a)),o=Math.min(1,Math.max(0,o)),i=Math.min(1,Math.max(0,i)),n[r]=Math.round(255*a),n[r+1]=Math.round(255*o),n[r+2]=Math.round(255*i)}}(r),$.curvesPanel&&function(e){h&&h.applyCurvesToImage(e)}(r),n.putImageData(r,0,0),t.toDataURL("image/jpeg",1)}catch(e){return console.error("Error processing advanced image:",e),null}}(e)}var $={activeMode:"basic",originalImage:null,processedImage:null,currentLutParams:{size:32,title:"Signature Look",contrast:1.2,saturation:1.15,redBalance:1.05,greenBalance:.95,blueBalance:1.1,shadowsShift:[.05,0,-.05],highlightsShift:[.03,.03,0],lumetri:{exposure:0,contrast:0,highlights:0,shadows:0,whites:0,blacks:0,temperature:0,tint:0}}};function Q(){if($.originalImage){console.log("Applying image adjustments");try{var e=K($.originalImageElement);e&&$.processedImageElement&&($.processedImageElement.src=e)}catch(e){console.error("Error processing image:",e)}}}window.applyImageAdjustments=Q,document.addEventListener("DOMContentLoaded",(function(){var e,n,r,a,o,i,c,u,s,f,v,g,p,y;console.log("LOTS App initializing..."),window.appState=$,console.log("Initializing UI Elements"),v=document.getElementById("view-code-btn"),g=document.getElementById("view-code-btn-advanced"),p=document.getElementById("code-modal"),y=document.getElementById("close-modal-btn"),v&&p&&v.addEventListener("click",(function(){F(!0),p.style.display="block"})),g&&p&&g.addEventListener("click",(function(){F(!0),p.style.display="block"})),y&&y.addEventListener("click",(function(){document.querySelectorAll(".modal").forEach((function(e){e.style.display="none"}))})),window.addEventListener("click",(function(e){document.querySelectorAll(".modal").forEach((function(t){e.target===t&&(t.style.display="none")}))})),[{toggle:"basic-correction-toggle",content:"basic-correction-section",expanded:!0},{toggle:"creative-toggle",content:"creative-section",expanded:!1},{toggle:"color-wheels-toggle",content:"color-wheels-section",expanded:!1},{toggle:"curves-toggle",content:"curves-section",expanded:!1}].forEach((function(e){var t=document.getElementById(e.toggle),n=document.getElementById(e.content);t&&n&&(e.expanded&&(t.classList.add("expanded"),n.classList.add("expanded")),t.addEventListener("click",(function(){t.classList.toggle("expanded"),n.classList.toggle("expanded")})))})),u=document.getElementById("minimize-btn"),s=document.getElementById("maximize-btn"),f=document.getElementById("close-btn"),u&&u.addEventListener("click",(function(){window.electronAPI&&window.electronAPI.windowControl("minimize")})),s&&s.addEventListener("click",(function(){window.electronAPI&&window.electronAPI.windowControl("maximize")})),f&&f.addEventListener("click",(function(){window.electronAPI&&window.electronAPI.windowControl("close")})),m(),function(){console.log("Initializing Creative Effects"),$.currentLutParams.creative||($.currentLutParams.creative={fadedFilm:0,vibrance:0});var e,t,n=document.getElementById("faded-film"),r=document.getElementById("vibrance"),a=document.getElementById("faded-film-value"),o=document.getElementById("vibrance-value");b(n,a,"fadedFilm"),b(r,o,"vibrance"),e=document.getElementById("creative-toggle"),t=document.getElementById("creative-section"),e&&t&&e.addEventListener("click",(function(){e.classList.toggle("expanded"),t.classList.toggle("expanded")}))}(),function(){console.log("Initializing Color Wheels"),$.currentLutParams.colorWheels||($.currentLutParams.colorWheels={shadowTint:{r:128,g:128,b:128},highlightTint:{r:128,g:128,b:128},tintBalance:0});var e=document.getElementById("shadow-color-wheel"),t=document.getElementById("highlight-color-wheel"),n=document.getElementById("tint-balance"),r=document.getElementById("tint-balance-value");e&&E(e,"shadowTint"),t&&E(t,"highlightTint"),n&&r&&(n.value=$.currentLutParams.colorWheels.tintBalance,r.textContent=$.currentLutParams.colorWheels.tintBalance.toFixed(1),n.addEventListener("input",(function(){$.currentLutParams.colorWheels.tintBalance=parseFloat(n.value),r.textContent=$.currentLutParams.colorWheels.tintBalance.toFixed(1),Q()})));var a,o,i=document.querySelector('.reset-btn[data-section="colorWheels"]');i&&i.addEventListener("click",x),a=document.getElementById("color-wheels-toggle"),o=document.getElementById("color-wheels-section"),a&&o&&a.addEventListener("click",(function(){a.classList.toggle("expanded"),o.classList.toggle("expanded")}))}(),console.log("Setting up Curves Panel"),$.currentLutParams.curves||($.currentLutParams.curves=JSON.parse(JSON.stringify(l))),h=new d($.currentLutParams.curves),i=document.getElementById("curves-toggle"),c=document.getElementById("curves-section"),i&&c&&i.addEventListener("click",(function(){i.classList.toggle("expanded"),c.classList.toggle("expanded")})),"complete"===document.readyState||"interactive"===document.readyState?setTimeout((function(){return h.init()}),0):document.addEventListener("DOMContentLoaded",(function(){return h.init()})),$.curvesPanel=h,console.log("Initializing Image Comparison"),function(){console.log("Initializing Preview Controller");var e,t,n,r=document.getElementById("original-image"),a=document.getElementById("processed-image"),o=document.getElementById("original-placeholder"),i=document.getElementById("comparison-container"),c=document.getElementById("image-upload-btn");$.originalImageElement=r,$.processedImageElement=a,e=document.getElementById("view-split"),t=document.getElementById("view-before"),n=document.getElementById("view-after"),e&&e.addEventListener("click",(function(){S("split")})),t&&t.addEventListener("click",(function(){S("before")})),n&&n.addEventListener("click",(function(){S("after")})),c&&c.addEventListener("click",M),r&&(r.onload=function(){console.log("Image loaded successfully"),$.originalImage=r,$.processedImage=a,o&&(o.style.display="none"),i&&(i.style.display="block"),function(){var e=document.getElementById("comparison-container"),t=document.getElementById("original-image-container"),n=document.getElementById("comparison-slider"),r=document.getElementById("vertical-divider"),a=!1,o=0,i=50;function c(e){e=Math.max(0,Math.min(100,e)),B=e,t.style.clipPath="inset(0 ".concat(100-e,"% 0 0)"),n.style.left=e+"%",r.style.left=e+"%"}n.addEventListener("mousedown",(function(e){a=!0,o=e.clientX;var t=parseFloat(n.style.left)||B;i=t,e.preventDefault()})),document.addEventListener("mousemove",(function(t){if(a){var n=e.getBoundingClientRect(),r=(t.clientX-o)/n.width*100;c(i+r),t.preventDefault()}})),document.addEventListener("mouseup",(function(){a=!1})),n.addEventListener("touchstart",(function(e){a=!0,o=e.touches[0].clientX;var t=parseFloat(n.style.left)||B;i=t,e.preventDefault()})),document.addEventListener("touchmove",(function(t){if(a){var n=e.getBoundingClientRect(),r=(t.touches[0].clientX-o)/n.width*100;c(i+r),t.preventDefault()}})),document.addEventListener("touchend",(function(){a=!1})),e.addEventListener("click",(function(t){if(!t.target.closest(".toggle-view")&&!t.target.closest(".slider-handle")){var n=e.getBoundingClientRect();c((t.clientX-n.left)/n.width*100)}})),c(B)}(),Q()})}(),function(){console.log("Initializing Presets");var e=document.querySelectorAll(".preset-btn");e.forEach((function(t){t.addEventListener("click",(function(){var n,r,a,o;e.forEach((function(e){return e.classList.remove("active")})),t.classList.add("active"),n=t.id.split("-")[1],(o=j[n]||T[n])?(console.log("Applying preset: ".concat(n)),$.activePresetId=n,$.currentLutParams.basic||($.currentLutParams.basic={}),$.currentLutParams.basic.contrast=o.contrast,$.currentLutParams.basic.saturation=o.saturation,$.currentLutParams.basic.redBalance=o.redBalance,$.currentLutParams.basic.greenBalance=o.greenBalance,$.currentLutParams.basic.blueBalance=o.blueBalance,o.shadowsShift&&($.currentLutParams.basic.shadowsShift=k(o.shadowsShift)),o.highlightsShift&&($.currentLutParams.basic.highlightsShift=k(o.highlightsShift)),o.advanced&&(void 0!==(r=o.advanced).temperature&&$.currentLutParams.lumetri&&($.currentLutParams.lumetri.temperature=r.temperature),void 0!==r.tint&&$.currentLutParams.lumetri&&($.currentLutParams.lumetri.tint=r.tint)),A("contrast",(a=$.currentLutParams.basic).contrast),A("saturation",a.saturation),A("red-balance",a.redBalance),A("green-balance",a.greenBalance),A("blue-balance",a.blueBalance),Q()):console.warn("Preset '".concat(n,"' not found"))}))})),function(){try{var e=localStorage.getItem("lotsAppUserPresets");e&&(T=JSON.parse(e),console.log("Loaded user presets:",Object.keys(T)))}catch(e){console.error("Failed to load user presets:",e)}}()}(),console.log("Initializing File Service"),console.log("Initializing LUT Generator Service"),window.generateCubeLUT=G,console.log("Initializing Export Service"),a=document.getElementById("save-lut-btn"),o=document.getElementById("save-lut-btn-advanced"),a&&a.addEventListener("click",J),o&&o.addEventListener("click",J),e=document.getElementById("mode-toggle"),n=document.getElementById("basic-controls"),r=document.getElementById("advanced-controls"),e&&e.addEventListener("change",(function(){var e=this.checked;$.activeMode=e?"advanced":"basic",n&&r&&(console.log("Switching to ".concat($.activeMode," mode")),n.style.display=e?"none":"block",r.style.display=e?"block":"none",e&&"function"==typeof t.setupAdvancedControls&&(0,t.setupAdvancedControls)(),$.originalImage&&$.processedImage&&Q())})),function(){var e=document.getElementById("minimize-btn"),t=document.getElementById("maximize-btn"),n=document.getElementById("close-btn");e&&e.addEventListener("click",(function(){window.electronAPI&&window.electronAPI.windowControl("minimize")})),t&&t.addEventListener("click",(function(){window.electronAPI&&window.electronAPI.windowControl("maximize")})),n&&n.addEventListener("click",(function(){window.electronAPI&&window.electronAPI.windowControl("close")}))}(),console.log("LOTS App initialized successfully")}))})();
//# sourceMappingURL=bundle.js.map